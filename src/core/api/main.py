import requests
import json
from fastapi import FastAPI
from random import shuffle
from fastapi.middleware.cors import CORSMiddleware
from gemini import send_with_history, gen_quiz
import uvicorn

app = FastAPI()
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],  # Permite solicitações do seu frontend
    allow_credentials=True,
    allow_methods=["*"],  # Permite todos os métodos HTTP (GET, POST, etc.)
    allow_headers=["*"],  # Permite todos os cabeçalhos
)
class Quiz:
    data: list[dict]

@app.get("/quiz")
def get_quiz(msg: str):
    quiz = gen_quiz(msg)
    return quiz

@app.get("/quiz_")
def get_quiz_(msg: str):
    return [{"question":"Qual o comando utilizado para imprimir algo na tela em Python?","id":1,"options":[{"id":3,"text":"display()"},{"id":4,"text":"show()"},{"id":2,"text":"echo()"},{"id":1,"text":"print()"}],"solution":1,"explanation":"O comando print() exibe o valor passado como argumento no console.","difficult":"easy"},{"question":"Qual o tipo de dado de '10'?","id":2,"options":[{"id":1,"text":"int"},{"id":4,"text":"bool"},{"id":3,"text":"float"},{"id":2,"text":"str"}],"solution":2,"explanation":"Como a string está entre aspas, ela é do tipo string (str).","difficult":"easy"},{"question":"Qual o tipo de dado de 10?","id":3,"options":[{"id":3,"text":"float"},{"id":2,"text":"str"},{"id":1,"text":"int"},{"id":4,"text":"bool"}],"solution":1,"explanation":"10 é um número inteiro, logo, é do tipo int.","difficult":"easy"},{"question":"Qual o tipo de dado de 10.5?","id":4,"options":[{"id":4,"text":"bool"},{"id":1,"text":"int"},{"id":2,"text":"str"},{"id":3,"text":"float"}],"solution":3,"explanation":"10.5 é um número com casas decimais, logo, é do tipo float.","difficult":"easy"},{"question":"Qual o operador de atribuição em Python?","id":5,"options":[{"id":4,"text":"="},{"id":2,"text":"+"},{"id":3,"text":"*"},{"id":1,"text":"-"}],"solution":4,"explanation":"O operador de atribuição em Python é o sinal de igual (=).","difficult":"easy"},{"question":"Como se declara uma variável em Python?","id":6,"options":[{"id":3,"text":"int x = 10;"},{"id":4,"text":"let x = 10;"},{"id":1,"text":"var x = 10;"},{"id":2,"text":"x = 10"}],"solution":2,"explanation":"Em Python, não é necessário declarar o tipo de dado da variável. Para declarar uma variável, basta atribuir um valor a ela.","difficult":"easy"},{"question":"O que o código 'x += 1' faz?","id":7,"options":[{"id":4,"text":"x = x / 1"},{"id":1,"text":"x = x - 1"},{"id":2,"text":"x = x + 1"},{"id":3,"text":"x = x * 1"}],"solution":2,"explanation":"É um operador de atribuição composto, equivalente a x = x + 1.","difficult":"medium"},{"question":"Qual a saída do código: print(type(10))?","id":8,"options":[{"id":2,"text":"<class 'int'>"},{"id":1,"text":"<class 'str'>"},{"id":3,"text":"<class 'float'>"},{"id":4,"text":"<class 'bool'>"}],"solution":2,"explanation":"A função type() retorna o tipo de dado de um valor. 10 é um inteiro, então o tipo é <class 'int'>.","difficult":"medium"},{"question":"Qual o resultado da operação 10 % 3?","id":9,"options":[{"id":1,"text":"3"},{"id":4,"text":"10"},{"id":2,"text":"1"},{"id":3,"text":"0"}],"solution":2,"explanation":"O operador % retorna o resto da divisão. 10 dividido por 3 é 3 com resto 1.","difficult":"medium"},{"question":"Qual a função utilizada para converter uma string em inteiro?","id":10,"options":[{"id":4,"text":"bool()"},{"id":3,"text":"float()"},{"id":2,"text":"int()"},{"id":1,"text":"str()"}],"solution":2,"explanation":"A função int() converte uma string que representa um número inteiro em um inteiro.","difficult":"medium"},{"question":"Como se cria uma lista em Python?","id":11,"options":[{"id":1,"text":"{1, 2, 3}"},{"id":2,"text":"[1, 2, 3]"},{"id":4,"text":"1, 2, 3"},{"id":3,"text":"(1, 2, 3)"}],"solution":2,"explanation":"Listas em Python são declaradas usando colchetes [].","difficult":"medium"},{"question":"Qual o comando para adicionar um elemento ao final de uma lista?","id":12,"options":[{"id":3,"text":"insert()"},{"id":4,"text":"push()"},{"id":1,"text":"append()"},{"id":2,"text":"add()"}],"solution":1,"explanation":"O método append() adiciona um elemento ao final da lista.","difficult":"medium"},{"question":"Como se define uma função em Python?","id":13,"options":[{"id":2,"text":"def minhaFuncao():"},{"id":4,"text":"function minhaFuncao {}"},{"id":3,"text":"minhaFuncao():"},{"id":1,"text":"function minhaFuncao() {}"}],"solution":2,"explanation":"Em Python, funções são definidas usando a palavra-chave 'def'.","difficult":"medium"},{"question":"O que faz um loop 'for' em Python?","id":14,"options":[{"id":1,"text":"Executa um bloco de código enquanto uma condição for verdadeira."},{"id":4,"text":"Cria uma variável."},{"id":3,"text":"Define uma função."},{"id":2,"text":"Executa um bloco de código um número específico de vezes."}],"solution":2,"explanation":"Um loop 'for' itera sobre uma sequência (como uma lista ou string) ou outros objetos iteráveis.","difficult":"medium"},{"question":"Qual a palavra chave para interromper um loop?","id":15,"options":[{"id":2,"text":"break"},{"id":1,"text":"continue"},{"id":4,"text":"exit"},{"id":3,"text":"stop"}],"solution":2,"explanation":"A palavra-chave 'break' interrompe o loop imediatamente.","difficult":"medium"},{"question":"Qual estrutura de dados é adequada para armazenar pares chave-valor?","id":16,"options":[{"id":1,"text":"List"},{"id":3,"text":"Dictionary"},{"id":4,"text":"Set"},{"id":2,"text":"Tuple"}],"solution":3,"explanation":"Um dicionário é ideal para representar dados como pares chave-valor.","difficult":"hard"},{"question":"Como se acessa um elemento em um dicionário?","id":17,"options":[{"id":4,"text":"Usando a posição"},{"id":3,"text":"Usando o nome"},{"id":1,"text":"Usando o índice"},{"id":2,"text":"Usando a chave"}],"solution":2,"explanation":"Elementos em dicionários são acessados via sua chave.","difficult":"hard"},{"question":"O que faz a instrução 'try...except'?","id":18,"options":[{"id":3,"text":"Define uma função"},{"id":4,"text":"Cria um loop"},{"id":2,"text":"Lida com exceções"},{"id":1,"text":"Executa um código repetidamente"}],"solution":2,"explanation":"'try...except' permite lidar com erros em tempo de execução sem interromper o programa.","difficult":"hard"},{"question":"Como importar um módulo em Python?","id":19,"options":[{"id":4,"text":"call modulo"},{"id":2,"text":"import modulo"},{"id":1,"text":"include <modulo>"},{"id":3,"text":"use modulo"}],"solution":2,"explanation":"A instrução 'import' é usada para carregar módulos externos.","difficult":"hard"},{"question":"Qual a diferença entre listas e tuplas em Python?","id":20,"options":[{"id":1,"text":"Não há diferença"},{"id":2,"text":"Listas são mutáveis, tuplas são imutáveis"},{"id":3,"text":"Listas são imutáveis, tuplas são mutáveis"},{"id":4,"text":"Listas são ordenadas, tuplas não são"}],"solution":2,"explanation":"Listas podem ser modificadas após sua criação, enquanto tuplas são imutáveis.","difficult":"hard"}]

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)